- name: Check if origins group exists and is not empty
  set_fact:
    origin_ips_exist: true
  when: "'origin' in groups and groups['origin'] | length > 0"

- name: Store origins IP addresses in a variable
  set_fact:
    origin_ips: "{{ groups['origin'] | map('extract', hostvars, 'ansible_host') | list }}"
  when: origin_ips_exist | default(false)

- name: Prompt for origins IP addresses
  pause:
    prompt: "Enter comma-separated list of origins IP addresses (e.g., 192.168.1.1,192.168.1.2):"
    echo: yes
  register: origin_ips_input
  when: not origin_ips_exist | default(false)

- name: Store origins IP addresses in a variable
  set_fact:
    origin_ips: "{{ origin_ips_input.user_input.split(',') | map('trim') | list }}"
  when: not origin_ips_exist | default(false)

- name: Print origins IPs
  debug:
    var: origin_ips

- name: Ask user to confirm origins IPs
  pause:
    prompt: "Please confirm the origins IP addresses above. Type 'yes' to continue or 'no' to cancel:"
    echo: yes
  register: user_confirmation

- name: Print origins IPs
  debug:
    var: user_confirmation

- name: Check if user confirmed the origins IPs
  fail:
    msg: "User did not confirm the origins IP addresses. Exiting."
  when: user_confirmation.user_input | lower != 'yes'

- name: Validate install option input
  fail:
    msg: "Invalid install option selected: {{ selected_install_option }}"
  when: selected_install_option not in ['1', '0']

- name: 
  set_fact:
    install_option: 'origin'
  when: selected_install_option == '0'

- name: 
  set_fact:
    install_option: 'edge'
  when: selected_install_option == '1'

- name:
  pause:
    prompt: "Do you want to use the origins in testing mode? (yes/no) [no]: "
    echo: yes
  register: testing_mode
  when: install_option == 'origin'

- name:
  pause:
    prompt: "\nEnter your postgresql password"
    echo: no
  register: postgres_password
  when: install_option == 'origin'

- name:
  pause:
    prompt: "\nEnter your provider wallet address. (The one with the staking)"
    echo: no
  register: public_key
  when: install_option == 'origin'

- name:
  pause:
    prompt: "\nEnter your wallet private key for resource(s) decrypt. This should match the public encryption key provided on the app. (It may or may not be the same as the staking one for security reasons)."
    echo: no
  register: private_key
  when: install_option == 'origin'

- name:
  pause:
    prompt: "\nEnter your wallet public key"
    echo: no
  register: wallet_address
  when: install_option == 'edge'

- name:
  pause:
    prompt: "\nEnter your wallet network"
    echo: no
  register: wallet_network
  when: install_option == 'edge'

- name:
  pause:
    prompt: "\nEnter your server disk space capability in Gigabytes"
  register: disk_space
  when: install_option == 'edge'

- name:
  pause:
    prompt: "\nEnter your server cpu cores capability"
  register: cpu_cores
  when: install_option == 'edge'

- name:
  pause:
    prompt: "\nEnter your server system ram capability in Gigabytes"
  register: system_ram
  when: install_option == 'edge'

- name:
  pause:
    prompt: "\nEnter the origin's public ssh key"
    echo: no
  register: public_ssh_key
  when: install_option == 'edge'